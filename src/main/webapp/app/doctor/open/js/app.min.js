'use strict';var COMPILED = false;
var goog = goog || {};
goog.global = this;
goog.global.CLOSURE_UNCOMPILED_DEFINES;
goog.global.CLOSURE_DEFINES;
goog.isDef = function(val) {
  return val !== void 0;
};
goog.exportPath_ = function(name, opt_object, opt_objectToExportTo) {
  var parts = name.split(".");
  var cur = opt_objectToExportTo || goog.global;
  if (!(parts[0] in cur) && cur.execScript) {
    cur.execScript("var " + parts[0]);
  }
  for (var part;parts.length && (part = parts.shift());) {
    if (!parts.length && goog.isDef(opt_object)) {
      cur[part] = opt_object;
    } else {
      if (cur[part]) {
        cur = cur[part];
      } else {
        cur = cur[part] = {};
      }
    }
  }
};
goog.define = function(name, defaultValue) {
  var value = defaultValue;
  if (!COMPILED) {
    if (goog.global.CLOSURE_UNCOMPILED_DEFINES && Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES, name)) {
      value = goog.global.CLOSURE_UNCOMPILED_DEFINES[name];
    } else {
      if (goog.global.CLOSURE_DEFINES && Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES, name)) {
        value = goog.global.CLOSURE_DEFINES[name];
      }
    }
  }
  goog.exportPath_(name, value);
};
goog.DEBUG = true;
goog.define("goog.LOCALE", "en");
goog.define("goog.TRUSTED_SITE", true);
goog.define("goog.STRICT_MODE_COMPATIBLE", false);
goog.provide = function(name) {
  if (!COMPILED) {
    if (goog.isProvided_(name)) {
      throw Error('Namespace "' + name + '" already declared.');
    }
    delete goog.implicitNamespaces_[name];
    var namespace = name;
    while (namespace = namespace.substring(0, namespace.lastIndexOf("."))) {
      if (goog.getObjectByName(namespace)) {
        break;
      }
      goog.implicitNamespaces_[namespace] = true;
    }
  }
  goog.exportPath_(name);
};
goog.setTestOnly = function(opt_message) {
  if (COMPILED && !goog.DEBUG) {
    opt_message = opt_message || "";
    throw Error("Importing test-only code into non-debug environment" + opt_message ? ": " + opt_message : ".");
  }
};
goog.forwardDeclare = function(name) {
};
if (!COMPILED) {
  goog.isProvided_ = function(name) {
    return !goog.implicitNamespaces_[name] && goog.isDefAndNotNull(goog.getObjectByName(name));
  };
  goog.implicitNamespaces_ = {};
}
goog.getObjectByName = function(name, opt_obj) {
  var parts = name.split(".");
  var cur = opt_obj || goog.global;
  for (var part;part = parts.shift();) {
    if (goog.isDefAndNotNull(cur[part])) {
      cur = cur[part];
    } else {
      return null;
    }
  }
  return cur;
};
goog.globalize = function(obj, opt_global) {
  var global = opt_global || goog.global;
  for (var x in obj) {
    global[x] = obj[x];
  }
};
goog.addDependency = function(relPath, provides, requires) {
  if (goog.DEPENDENCIES_ENABLED) {
    var provide, require;
    var path = relPath.replace(/\\/g, "/");
    var deps = goog.dependencies_;
    for (var i = 0;provide = provides[i];i++) {
      deps.nameToPath[provide] = path;
      if (!(path in deps.pathToNames)) {
        deps.pathToNames[path] = {};
      }
      deps.pathToNames[path][provide] = true;
    }
    for (var j = 0;require = requires[j];j++) {
      if (!(path in deps.requires)) {
        deps.requires[path] = {};
      }
      deps.requires[path][require] = true;
    }
  }
};
goog.define("goog.ENABLE_DEBUG_LOADER", true);
goog.require = function(name) {
  if (!COMPILED) {
    if (goog.isProvided_(name)) {
      return;
    }
    if (goog.ENABLE_DEBUG_LOADER) {
      var path = goog.getPathFromDeps_(name);
      if (path) {
        goog.included_[path] = true;
        goog.writeScripts_();
        return;
      }
    }
    var errorMessage = "goog.require could not find: " + name;
    if (goog.global.console) {
      goog.global.console["error"](errorMessage);
    }
    throw Error(errorMessage);
  }
};
goog.basePath = "";
goog.global.CLOSURE_BASE_PATH;
goog.global.CLOSURE_NO_DEPS;
goog.global.CLOSURE_IMPORT_SCRIPT;
goog.nullFunction = function() {
};
goog.identityFunction = function(opt_returnValue, var_args) {
  return opt_returnValue;
};
goog.abstractMethod = function() {
  throw Error("unimplemented abstract method");
};
goog.addSingletonGetter = function(ctor) {
  ctor.getInstance = function() {
    if (ctor.instance_) {
      return ctor.instance_;
    }
    if (goog.DEBUG) {
      goog.instantiatedSingletons_[goog.instantiatedSingletons_.length] = ctor;
    }
    return ctor.instance_ = new ctor;
  };
};
goog.instantiatedSingletons_ = [];
goog.DEPENDENCIES_ENABLED = !COMPILED && goog.ENABLE_DEBUG_LOADER;
if (goog.DEPENDENCIES_ENABLED) {
  goog.included_ = {};
  goog.dependencies_ = {pathToNames:{}, nameToPath:{}, requires:{}, visited:{}, written:{}};
  goog.inHtmlDocument_ = function() {
    var doc = goog.global.document;
    return typeof doc != "undefined" && "write" in doc;
  };
  goog.findBasePath_ = function() {
    if (goog.global.CLOSURE_BASE_PATH) {
      goog.basePath = goog.global.CLOSURE_BASE_PATH;
      return;
    } else {
      if (!goog.inHtmlDocument_()) {
        return;
      }
    }
    var doc = goog.global.document;
    var scripts = doc.getElementsByTagName("script");
    for (var i = scripts.length - 1;i >= 0;--i) {
      var src = scripts[i].src;
      var qmark = src.lastIndexOf("?");
      var l = qmark == -1 ? src.length : qmark;
      if (src.substr(l - 7, 7) == "base.js") {
        goog.basePath = src.substr(0, l - 7);
        return;
      }
    }
  };
  goog.importScript_ = function(src) {
    var importScript = goog.global.CLOSURE_IMPORT_SCRIPT || goog.writeScriptTag_;
    if (!goog.dependencies_.written[src] && importScript(src)) {
      goog.dependencies_.written[src] = true;
    }
  };
  goog.writeScriptTag_ = function(src) {
    if (goog.inHtmlDocument_()) {
      var doc = goog.global.document;
      if (doc.readyState == "complete") {
        var isDeps = /\bdeps.js$/.test(src);
        if (isDeps) {
          return false;
        } else {
          throw Error('Cannot write "' + src + '" after document load');
        }
      }
      doc.write('<script type="text/javascript" src="' + src + '"></' + "script>");
      return true;
    } else {
      return false;
    }
  };
  goog.writeScripts_ = function() {
    var scripts = [];
    var seenScript = {};
    var deps = goog.dependencies_;
    function visitNode(path) {
      if (path in deps.written) {
        return;
      }
      if (path in deps.visited) {
        if (!(path in seenScript)) {
          seenScript[path] = true;
          scripts.push(path);
        }
        return;
      }
      deps.visited[path] = true;
      if (path in deps.requires) {
        for (var requireName in deps.requires[path]) {
          if (!goog.isProvided_(requireName)) {
            if (requireName in deps.nameToPath) {
              visitNode(deps.nameToPath[requireName]);
            } else {
              throw Error("Undefined nameToPath for " + requireName);
            }
          }
        }
      }
      if (!(path in seenScript)) {
        seenScript[path] = true;
        scripts.push(path);
      }
    }
    for (var path in goog.included_) {
      if (!deps.written[path]) {
        visitNode(path);
      }
    }
    for (var i = 0;i < scripts.length;i++) {
      if (scripts[i]) {
        goog.importScript_(goog.basePath + scripts[i]);
      } else {
        throw Error("Undefined script input");
      }
    }
  };
  goog.getPathFromDeps_ = function(rule) {
    if (rule in goog.dependencies_.nameToPath) {
      return goog.dependencies_.nameToPath[rule];
    } else {
      return null;
    }
  };
  goog.findBasePath_();
  if (!goog.global.CLOSURE_NO_DEPS) {
    goog.importScript_(goog.basePath + "deps.js");
  }
}
goog.typeOf = function(value) {
  var s = typeof value;
  if (s == "object") {
    if (value) {
      if (value instanceof Array) {
        return "array";
      } else {
        if (value instanceof Object) {
          return s;
        }
      }
      var className = Object.prototype.toString.call((value));
      if (className == "[object Window]") {
        return "object";
      }
      if (className == "[object Array]" || typeof value.length == "number" && typeof value.splice != "undefined" && typeof value.propertyIsEnumerable != "undefined" && !value.propertyIsEnumerable("splice")) {
        return "array";
      }
      if (className == "[object Function]" || typeof value.call != "undefined" && typeof value.propertyIsEnumerable != "undefined" && !value.propertyIsEnumerable("call")) {
        return "function";
      }
    } else {
      return "null";
    }
  } else {
    if (s == "function" && typeof value.call == "undefined") {
      return "object";
    }
  }
  return s;
};
goog.isNull = function(val) {
  return val === null;
};
goog.isDefAndNotNull = function(val) {
  return val != null;
};
goog.isArray = function(val) {
  return goog.typeOf(val) == "array";
};
goog.isArrayLike = function(val) {
  var type = goog.typeOf(val);
  return type == "array" || type == "object" && typeof val.length == "number";
};
goog.isDateLike = function(val) {
  return goog.isObject(val) && typeof val.getFullYear == "function";
};
goog.isString = function(val) {
  return typeof val == "string";
};
goog.isBoolean = function(val) {
  return typeof val == "boolean";
};
goog.isNumber = function(val) {
  return typeof val == "number";
};
goog.isFunction = function(val) {
  return goog.typeOf(val) == "function";
};
goog.isObject = function(val) {
  var type = typeof val;
  return type == "object" && val != null || type == "function";
};
goog.getUid = function(obj) {
  return obj[goog.UID_PROPERTY_] || (obj[goog.UID_PROPERTY_] = ++goog.uidCounter_);
};
goog.hasUid = function(obj) {
  return !!obj[goog.UID_PROPERTY_];
};
goog.removeUid = function(obj) {
  if ("removeAttribute" in obj) {
    obj.removeAttribute(goog.UID_PROPERTY_);
  }
  try {
    delete obj[goog.UID_PROPERTY_];
  } catch (ex) {
  }
};
goog.UID_PROPERTY_ = "closure_uid_" + (Math.random() * 1E9 >>> 0);
goog.uidCounter_ = 0;
goog.getHashCode = goog.getUid;
goog.removeHashCode = goog.removeUid;
goog.cloneObject = function(obj) {
  var type = goog.typeOf(obj);
  if (type == "object" || type == "array") {
    if (obj.clone) {
      return obj.clone();
    }
    var clone = type == "array" ? [] : {};
    for (var key in obj) {
      clone[key] = goog.cloneObject(obj[key]);
    }
    return clone;
  }
  return obj;
};
goog.bindNative_ = function(fn, selfObj, var_args) {
  return (fn.call.apply(fn.bind, arguments));
};
goog.bindJs_ = function(fn, selfObj, var_args) {
  if (!fn) {
    throw new Error;
  }
  if (arguments.length > 2) {
    var boundArgs = Array.prototype.slice.call(arguments, 2);
    return function() {
      var newArgs = Array.prototype.slice.call(arguments);
      Array.prototype.unshift.apply(newArgs, boundArgs);
      return fn.apply(selfObj, newArgs);
    };
  } else {
    return function() {
      return fn.apply(selfObj, arguments);
    };
  }
};
goog.bind = function(fn, selfObj, var_args) {
  if (Function.prototype.bind && Function.prototype.bind.toString().indexOf("native code") != -1) {
    goog.bind = goog.bindNative_;
  } else {
    goog.bind = goog.bindJs_;
  }
  return goog.bind.apply(null, arguments);
};
goog.partial = function(fn, var_args) {
  var args = Array.prototype.slice.call(arguments, 1);
  return function() {
    var newArgs = args.slice();
    newArgs.push.apply(newArgs, arguments);
    return fn.apply(this, newArgs);
  };
};
goog.mixin = function(target, source) {
  for (var x in source) {
    target[x] = source[x];
  }
};
goog.now = goog.TRUSTED_SITE && Date.now || function() {
  return +new Date;
};
goog.globalEval = function(script) {
  if (goog.global.execScript) {
    goog.global.execScript(script, "JavaScript");
  } else {
    if (goog.global.eval) {
      if (goog.evalWorksForGlobals_ == null) {
        goog.global.eval("var _et_ = 1;");
        if (typeof goog.global["_et_"] != "undefined") {
          delete goog.global["_et_"];
          goog.evalWorksForGlobals_ = true;
        } else {
          goog.evalWorksForGlobals_ = false;
        }
      }
      if (goog.evalWorksForGlobals_) {
        goog.global.eval(script);
      } else {
        var doc = goog.global.document;
        var scriptElt = doc.createElement("script");
        scriptElt.type = "text/javascript";
        scriptElt.defer = false;
        scriptElt.appendChild(doc.createTextNode(script));
        doc.body.appendChild(scriptElt);
        doc.body.removeChild(scriptElt);
      }
    } else {
      throw Error("goog.globalEval not available");
    }
  }
};
goog.evalWorksForGlobals_ = null;
goog.cssNameMapping_;
goog.cssNameMappingStyle_;
goog.getCssName = function(className, opt_modifier) {
  var getMapping = function(cssName) {
    return goog.cssNameMapping_[cssName] || cssName;
  };
  var renameByParts = function(cssName) {
    var parts = cssName.split("-");
    var mapped = [];
    for (var i = 0;i < parts.length;i++) {
      mapped.push(getMapping(parts[i]));
    }
    return mapped.join("-");
  };
  var rename;
  if (goog.cssNameMapping_) {
    rename = goog.cssNameMappingStyle_ == "BY_WHOLE" ? getMapping : renameByParts;
  } else {
    rename = function(a) {
      return a;
    };
  }
  if (opt_modifier) {
    return className + "-" + rename(opt_modifier);
  } else {
    return rename(className);
  }
};
goog.setCssNameMapping = function(mapping, opt_style) {
  goog.cssNameMapping_ = mapping;
  goog.cssNameMappingStyle_ = opt_style;
};
goog.global.CLOSURE_CSS_NAME_MAPPING;
if (!COMPILED && goog.global.CLOSURE_CSS_NAME_MAPPING) {
  goog.cssNameMapping_ = goog.global.CLOSURE_CSS_NAME_MAPPING;
}
goog.getMsg = function(str, opt_values) {
  var values = opt_values || {};
  for (var key in values) {
    var value = ("" + values[key]).replace(/\$/g, "$$$$");
    str = str.replace(new RegExp("\\{\\$" + key + "\\}", "gi"), value);
  }
  return str;
};
goog.getMsgWithFallback = function(a, b) {
  return a;
};
goog.exportSymbol = function(publicPath, object, opt_objectToExportTo) {
  goog.exportPath_(publicPath, object, opt_objectToExportTo);
};
goog.exportProperty = function(object, publicName, symbol) {
  object[publicName] = symbol;
};
goog.inherits = function(childCtor, parentCtor) {
  function tempCtor() {
  }
  tempCtor.prototype = parentCtor.prototype;
  childCtor.superClass_ = parentCtor.prototype;
  childCtor.prototype = new tempCtor;
  childCtor.prototype.constructor = childCtor;
  childCtor.base = function(me, methodName, var_args) {
    var args = Array.prototype.slice.call(arguments, 2);
    return parentCtor.prototype[methodName].apply(me, args);
  };
};
goog.base = function(me, opt_methodName, var_args) {
  var caller = arguments.callee.caller;
  if (goog.STRICT_MODE_COMPATIBLE || goog.DEBUG && !caller) {
    throw Error("arguments.caller not defined.  goog.base() cannot be used " + "with strict mode code. See " + "http://www.ecma-international.org/ecma-262/5.1/#sec-C");
  }
  if (caller.superClass_) {
    return caller.superClass_.constructor.apply(me, Array.prototype.slice.call(arguments, 1));
  }
  var args = Array.prototype.slice.call(arguments, 2);
  var foundCaller = false;
  for (var ctor = me.constructor;ctor;ctor = ctor.superClass_ && ctor.superClass_.constructor) {
    if (ctor.prototype[opt_methodName] === caller) {
      foundCaller = true;
    } else {
      if (foundCaller) {
        return ctor.prototype[opt_methodName].apply(me, args);
      }
    }
  }
  if (me[opt_methodName] === caller) {
    return me.constructor.prototype[opt_methodName].apply(me, args);
  } else {
    throw Error("goog.base called from a method of one name " + "to a method of a different name");
  }
};
goog.scope = function(fn) {
  fn.call(goog.global);
};
goog.provide("jxdctopn.panel.forgot_password.Ctrl");
jxdctopn.panel.forgot_password.Ctrl.$inject = ["$window", "basic", "$timeout", "md5"];
jxdctopn.panel.forgot_password.Ctrl = function($window, basic, $timeout, md5) {
  var ctrl = this;
  ctrl.alert_msg = undefined;
  ctrl.alert_type = undefined;
  ctrl.forgotPasswordInf = {login_name:"", certification_code:"", password:""};
  ctrl.getVerCodeInf = {user_name:"", user_role:"doctor", used_for:1};
  ctrl.password = undefined;
  ctrl.confirm_password = undefined;
  ctrl.verificationCode = function() {
    ctrl.setVerBtnDisabled("verCodeBtn", true);
    ctrl.getVerCodeInf.user_name = ctrl.forgotPasswordInf.login_name;
    if (!validParam(ctrl.getVerCodeInf.user_name)) {
      return;
    }
    return basic.verificationCode(ctrl.getVerCodeInf).then(function(res) {
      console.log(res);
      if (validParam(res.error_message) && res.error_message.faultcode == 1001004) {
        ctrl.addAlert("danger", res.error_message.faultstring);
        ctrl.setVerBtnDisabled("verCodeBtn", false);
        return;
      } else {
        if (validParam(res.success_message)) {
          $timeout(function() {
            ctrl.setVerBtnDisabled("verCodeBtn", false);
          }, 1E3 * 60);
          ctrl.addAlert("info", "\u9a8c\u8bc1\u7801\u53d1\u9001\u6210\u529f\uff0c\u8bf7\u67e5\u6536\u3002");
        }
      }
    }, function(error) {
      ctrl.addAlert("danger", error.error_message.faultstring);
      ctrl.setVerBtnDisabled("verCodeBtn", false);
    });
  };
  ctrl.setVerBtnDisabled = function(name, status) {
    var btn = document.getElementById(name);
    btn.disabled = status;
  };
  ctrl.forgotPassword = function() {
    if (ctrl.forgotPasswordInf.login_name == "" || ctrl.forgotPasswordInf.login_name == null) {
      return;
    }
    if (ctrl.forgotPasswordInf.certification_code == "" || ctrl.forgotPasswordInf.certification_code == null) {
      return;
    }
    if (ctrl.password == "" || ctrl.password == null) {
      return;
    }
    if (ctrl.confirm_password == "" || ctrl.confirm_password == null) {
      return;
    }
    if (ctrl.password != ctrl.confirm_password) {
      ctrl.addAlert("warning", "\u5bc6\u7801\u4e0d\u4e00\u81f4");
      return;
    }
    ctrl.setVerBtnDisabled("forgotBtn", true);
    ctrl.forgotPasswordInf.password = md5.createHash(ctrl.password);
    basic.resetPassword(ctrl.forgotPasswordInf).then(function(res) {
      if (res.success_message == undefined) {
        if (res.error_message.faultcode == 1001002) {
          ctrl.addAlert("warning", "\u9a8c\u8bc1\u7801\u9519\u8bef");
        } else {
          ctrl.addAlert("danger", res.error_message.faultstring);
        }
        ctrl.setVerBtnDisabled("forgotBtn", false);
        return;
      }
      ctrl.addAlert("success", "\u5bc6\u7801\u91cd\u7f6e\u6210\u529f\u3002");
    }, function(error) {
      ctrl.addAlert("danger", error.error_message.faultstring);
      ctrl.setVerBtnDisabled("forgotBtn", false);
    });
  };
  ctrl.addAlert = function(type, msg) {
    ctrl.alert_type = type;
    ctrl.alert_msg = msg;
    $timeout(function() {
      ctrl.closeAlert();
    }, 3E3);
  };
  ctrl.closeAlert = function() {
    ctrl.alert_type = undefined;
    ctrl.alert_msg = undefined;
  };
  ctrl.checkPassword = function() {
    var node = document.getElementById("password_group");
    var re_node = document.getElementById("password_repeat_group");
    if (ctrl.password != null) {
      node.className = "form-group col-md-offset-1 col-md-9 has-success";
    } else {
      node.className = "form-group col-md-offset-1 col-md-9 has-error";
    }
    if (ctrl.confirm_password != ctrl.password) {
      re_node.className = "form-group col-md-offset-1 col-md-9 has-error";
    } else {
      re_node.className = "form-group col-md-offset-1 col-md-9 has-success";
    }
  };
  ctrl.checkPasswordRepeat = function() {
    var node = document.getElementById("password_repeat_group");
    if (ctrl.confirm_password != null) {
      node.className = "form-group col-md-offset-1 col-md-9 has-success";
    } else {
      node.className = "form-group col-md-offset-1 col-md-9 has-error";
    }
    if (ctrl.confirm_password != ctrl.password) {
      node.className = "form-group col-md-offset-1 col-md-9 has-error";
    }
  };
  function validParam(param) {
    if (param != undefined && param != null && param != "") {
      return true;
    }
    return false;
  }
  this.$window = $window;
};
jxdctopn.panel.forgot_password.Ctrl.prototype.say = function() {
  var $window = this.$window;
  $window.alert(this.text);
};
goog.provide("jxdctopn.panel.forgot_password.module");
goog.require("jxdctopn.panel.forgot_password.Ctrl");
jxdctopn.panel.forgot_password.module = angular.module("panel.forgot_password", ["ui.router", "angular-md5"]);
jxdctopn.panel.forgot_password.module.configuration = function($stateProvider) {
  $stateProvider.state("panel.forgot_password", {url:"/forgot_password", templateUrl:"states/panel/forgot_password/forgot_password.html", controller:"ForgotPasswordCtrl as forgotPassword"});
};
jxdctopn.panel.forgot_password.module.config(jxdctopn.panel.forgot_password.module.configuration).controller("ForgotPasswordCtrl", jxdctopn.panel.forgot_password.Ctrl);
goog.provide("jxdctopn.panel.Ctrl");
jxdctopn.panel.Ctrl = function() {
  this.label = "some label from panel controller";
};
jxdctopn.panel.Ctrl.prototype.log = function(text) {
  console.log(text);
};
goog.provide("jxdctopn.panel.sign_in.Ctrl");
jxdctopn.panel.sign_in.Ctrl.$inject = ["$window", "basic", "$rootScope", "md5", "$timeout"];
jxdctopn.panel.sign_in.Ctrl = function($window, basic, $rootScope, md5, $timeout) {
  var ctrl = this;
  ctrl.show_err_flag = false;
  ctrl.errmsg = "";
  ctrl.userLoginInfo = {login_name:"", password:"", captcha:""};
  ctrl.password = "";
  ctrl.signIn = function() {
    if (ctrl.userLoginInfo.login_name == undefined || ctrl.userLoginInfo.login_name == "") {
      return;
    }
    if (ctrl.password == undefined || ctrl.password == "") {
      return;
    }
    if (ctrl.userLoginInfo.captcha == undefined || ctrl.userLoginInfo.captcha == "") {
      return;
    }
    ctrl.userLoginInfo.password = md5.createHash(ctrl.password);
    basic.signIn(ctrl.userLoginInfo).then(function(res) {
      if (res.success_message == undefined) {
        if (res.error_message.faultcode == 1001022) {
          ctrl.addAlert("warning", "\u9a8c\u8bc1\u7801\u9519\u8bef");
        } else {
          if (res.error_message.faultcode == 1002036) {
            ctrl.captcha_click();
            ctrl.addAlert("warning", "\u8be5\u7528\u6237\u5c1a\u672a\u6fc0\u6d3b,\u8bf7\u8054\u7cfb\u7ba1\u7406\u5458");
          } else {
            ctrl.captcha_click();
            ctrl.addAlert("danger", "\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef");
          }
        }
        return;
      }
      $window.location.href = "/doctor/secured";
    }, function(error) {
      ctrl.addAlert("danger", "\u7cfb\u7edf\u9519\u8bef");
    });
  };
  ctrl.captcha_url = $rootScope.endPoint + "/common/sign_in_captcha?d=" + (new Date).getTime();
  ctrl.captcha_click = function() {
    ctrl.userLoginInfo.captcha = "";
    var time = (new Date).getTime();
    ctrl.captcha_url = $rootScope.endPoint + "/common/sign_in_captcha?d=" + time;
  };
  ctrl.alert_type = undefined;
  ctrl.alert_msg = undefined;
  ctrl.addAlert = function(type, msg) {
    ctrl.alert_type = type;
    ctrl.alert_msg = msg;
    $timeout(function() {
      ctrl.closeAlert();
    }, 3E3);
  };
  ctrl.closeAlert = function() {
    ctrl.alert_type = undefined;
    ctrl.alert_msg = undefined;
  };
};
goog.provide("jxdctopn.panel.sign_in.module");
goog.require("jxdctopn.panel.sign_in.Ctrl");
jxdctopn.panel.sign_in.module = angular.module("panel.sign_in", ["ui.router", "angular-md5"]);
jxdctopn.panel.sign_in.module.configuration = function($stateProvider) {
  $stateProvider.state("panel.sign_in", {url:"/sign_in", templateUrl:"states/panel/sign_in/sign_in.html", controller:"SignInCtrl as signIn"});
};
jxdctopn.panel.sign_in.module.config(jxdctopn.panel.sign_in.module.configuration).controller("SignInCtrl", jxdctopn.panel.sign_in.Ctrl);
goog.provide("jxdctopn.panel.module");
goog.require("jxdctopn.panel.sign_in.module");
goog.require("jxdctopn.panel.forgot_password.module");
goog.require("jxdctopn.panel.Ctrl");
jxdctopn.panel.module = angular.module("panel", ["ui.router", jxdctopn.panel.sign_in.module.name, jxdctopn.panel.forgot_password.module.name, "ui.bootstrap"]);
jxdctopn.panel.module.configuration = function($stateProvider) {
  $stateProvider.state("panel", {url:"/panel", templateUrl:"states/panel/panel.html", controller:"PanelCtrl as panel"});
};
jxdctopn.panel.module.config(jxdctopn.panel.module.configuration).controller("PanelCtrl", jxdctopn.panel.Ctrl);
goog.provide("jxdctopn.sign_up.Ctrl");
jxdctopn.sign_up.Ctrl.$inject = ["$scope", "$q", "$filter", "constants", "$rootScope", "basic", "md5", "$timeout", "$location"];
jxdctopn.sign_up.Ctrl = function($scope, $q, constants, basic, md5, $rootScope, $timeout, $location, $filter) {
  var ctrl = this;
  ctrl.genders = constants.gotGENDERS();
  ctrl.gender = {selected:ctrl.genders[0]};
  ctrl.departments = constants.gotDEPARTMENTS();
  ctrl.department = {selected:undefined};
  ctrl.distrits = constants.gotDISTRICTS();
  ctrl.signUpInf = {login_name:"", password:"", full_name:"", identification_number:"", gender:"", birthday:"", email:"", avatar_url:"", phone:"", department_id:1, district_id:1, profile:"", physician_certificate:"", practicing_certificate:"", captcha:""};
  ctrl.password = "";
  ctrl.confirm_password = "";
  ctrl.avatar_url = "";
  ctrl.physician_certificate = "";
  ctrl.practicing_certificate = "";
  activate();
  function activate() {
  }
  ctrl.today = function() {
    ctrl.dt = new Date;
  };
  ctrl.today();
  ctrl.clear = function() {
    ctrl.dt = null;
  };
  ctrl.disabled = function(date, mode) {
  };
  ctrl.toggleMin = function() {
  };
  ctrl.toggleMin();
  ctrl.open = function($event) {
    $event.preventDefault();
    $event.stopPropagation();
    ctrl.opened = true;
  };
  ctrl.dateOptions = {startingDay:1};
  ctrl.formats = ["yyyy-MM-dd", "yyyy/MM/dd", "dd.MM.yyyy", "shortDate"];
  ctrl.format = ctrl.formats[0];
  var tomorrow = new Date;
  tomorrow.setDate(tomorrow.getDate() + 1);
  var afterTomorrow = new Date;
  afterTomorrow.setDate(tomorrow.getDate() + 2);
  ctrl.events = [{date:tomorrow, status:"full"}, {date:afterTomorrow, status:"partially"}];
  ctrl.getDayClass = function(date, mode) {
    if (mode === "day") {
      var dayToCheck = (new Date(date)).setHours(0, 0, 0, 0);
      for (var i = 0;i < ctrl.events.length;i++) {
        var currentDay = (new Date(ctrl.events[i].date)).setHours(0, 0, 0, 0);
        if (dayToCheck === currentDay) {
          return ctrl.events[i].status;
        }
      }
    }
    return "";
  };
  ctrl.captcha_url = $rootScope.endPoint + "/common/sign_in_captcha?d=" + (new Date).getTime();
  ctrl.captcha_click = function() {
    var time = (new Date).getTime();
    ctrl.captcha_url = $rootScope.endPoint + "/common/sign_in_captcha?d=" + time;
  };
  ctrl.avatarFile = undefined;
  ctrl.idenFile = undefined;
  ctrl.proIdenFile = undefined;
  var uploadAvatarFiles = function() {
    if (validParam(ctrl.avatarFile)) {
      return basic.fileUpload(ctrl.avatarFile).then(function(res) {
        ctrl.signUpInf.avatar_url = res.success_message[0];
        console.log("\u4e0a\u4f20\u5934\u50cf\u6210\u529f\uff01");
        console.log(ctrl.signUpInf.avatar_url);
        return res;
      }, function(error) {
        console.log("\u4e0a\u4f20\u5934\u50cf\u5931\u8d25\uff01");
        console.log(error);
        return error;
      });
    } else {
      return $q.when(0);
    }
  };
  var uploadIdenFiles = function() {
    if (validParam(ctrl.idenFile)) {
      return basic.fileUpload(ctrl.idenFile).then(function(res) {
        ctrl.signUpInf.practicing_certificate = res.success_message[0];
        console.log("\u4e0a\u4f20\u5934\u8d44\u683c\u8bc1\u4e66\u6210\u529f\uff01");
        return res;
      }, function(error) {
        console.log("\u4e0a\u4f20\u5934\u8d44\u683c\u8bc1\u4e66\u5931\u8d25\uff01");
        console.log(error);
        return error;
      });
    } else {
      return $q.when(0);
    }
  };
  var uploadProIdenFiles = function() {
    if (validParam(ctrl.proIdenFile)) {
      return basic.fileUpload(ctrl.proIdenFile).then(function(res) {
        ctrl.signUpInf.physician_certificate = res.success_message[0];
        console.log("\u4e0a\u4f20\u6267\u4e1a\u8bc1\u4e66\u6210\u529f\uff01");
        return res;
      }, function(error) {
        console.log("\u4e0a\u4f20\u6267\u4e1a\u8bc1\u4e66\u5931\u8d25\uff01");
        console.log(error);
        return error;
      });
    } else {
      return $q.when(0);
    }
  };
  ctrl.signUp = function() {
    if (ctrl.password == ctrl.confirm_password) {
      ctrl.signUpInf.gender = ctrl.gender.selected.gender_id;
      ctrl.signUpInf.password = md5.createHash(ctrl.password);
      if (validParam(ctrl.avatarFile) && !validPic(ctrl.avatarFile, "png|jpg|jpeg|gif")) {
        $scope.addAlert("warning", "\u5934\u50cf\u8bf7\u4e0a\u4f20png\u3001jpg\u7c7b\u578b\u7684\u6587\u4ef6\uff01");
        return;
      }
      if (!validParam(ctrl.idenFile) || !validPic(ctrl.idenFile, "png|jpg|jpeg|gif")) {
        $scope.addAlert("warning", "\u8d44\u683c\u8bc1\u4e66\u8bf7\u4e0a\u4f20png\u3001jpg\u7c7b\u578b\u7684\u6587\u4ef6\uff01");
        return;
      }
      if (!validParam(ctrl.proIdenFile) || !validPic(ctrl.proIdenFile, "png|jpg|jpeg|gif")) {
        $scope.addAlert("warning", "\u6267\u4e1a\u8bc1\u4e66\u8bf7\u4e0a\u4f20png\u3001jpg\u7c7b\u578b\u7684\u6587\u4ef6\uff01");
        return;
      }
      var promises = [uploadAvatarFiles(), uploadIdenFiles(), uploadProIdenFiles()];
      if (validParam(ctrl.signUpInf.birthday)) {
        ctrl.signUpInf.birthday = $filter("date")(ctrl.signUpInf.birthday, "yyyy-M-dd");
      }
      if (validParam(ctrl.signUpInf.phone) && !isMobileOrTell(ctrl.signUpInf.phone)) {
        $scope.addAlert("warning", "\u8054\u7cfb\u7535\u8bdd\u975e\u6cd5\uff01");
        return;
      }
      return $q.all(promises).then(function() {
        basic.signUp(ctrl.signUpInf).then(function(res) {
          $scope.addAlert("success", "\u6ce8\u518c\u6210\u529f\uff0c3\u79d2\u949f\u540e\u8df3\u8f6c\u5230\u767b\u9646\u9875\u9762\uff01");
          $timeout(function() {
            $location.url("/panel/sign_in");
          }, 3E3);
        }, function(error) {
          ctrl.errmsg = error;
          if (validParam(error.error_message.faultstring)) {
            $scope.addAlert("danger", error.error_message.faultstring);
            ctrl.captcha_click();
          }
        });
      }, function(error) {
        console.log(error);
      });
    }
  };
  function isMobileOrTell(str) {
    var mobile = /^1\d{10}$/;
    var tel = /^0\d{2,3}-?\d{7,8}$/;
    if (mobile.test(str) || tel.test(str)) {
      return true;
    }
    return false;
  }
  $scope.alerts = [];
  $scope.addAlert = function(type, msg) {
    var alert = {"type":type, "msg":msg};
    $scope.alerts.push(alert);
    $timeout(function() {
      $scope.closeAlert($scope.alerts.indexOf(alert));
    }, 6E3);
  };
  $scope.closeAlert = function(index) {
    $scope.alerts.splice(index, 1);
  };
  $scope.clearAlerts = function() {
    $scope.alerts = [];
  };
  var validParam = function(param) {
    if (param != undefined && param != null && param != "") {
      return true;
    }
    return false;
  };
  function validPic(file, str) {
    if (file != undefined && file.type != undefined && str != undefined && str != "" && str.length != 0) {
      var suffixs = str.split("|");
      var fileSuf = file.type.split("/");
      var res = suffixs.filter(function(item) {
        return item == fileSuf[1];
      });
      if (res.length != 0) {
        return true;
      }
      return false;
    }
  }
};
goog.provide("jxdctopn.sign_up.module");
goog.require("jxdctopn.sign_up.Ctrl");
jxdctopn.sign_up.module = angular.module("sign_up", ["ui.router", "ui.select", "ui.bootstrap", "ngSanitize"]);
jxdctopn.sign_up.module.configuration = function($stateProvider) {
  $stateProvider.state("sign_up", {url:"/sign_up", templateUrl:"states/sign_up/sign_up.html", controller:"SignUpCtrl as signUp", resolve:{"DISTRICTSPromise":function(constants) {
    return constants.DISTRICTSPromise;
  }, "DEPARTMENTSPromise":function(constants) {
    return constants.DEPARTMENTSPromise;
  }, "GENDERSPromise":function(constants) {
    return constants.GENDERSPromise;
  }}});
};
jxdctopn.sign_up.module.config(jxdctopn.sign_up.module.configuration).controller("SignUpCtrl", jxdctopn.sign_up.Ctrl);
goog.provide("jxdctsec.fileModel.Directive.factory");
jxdctsec.fileModel.Directive = function($parse) {
  this.parse = $parse;
  this.link = this.link.bind(this);
  this.scope;
  this.elem;
  this.attrs;
};
jxdctsec.fileModel.Directive.factory = function($parse) {
  var dir = new jxdctsec.fileModel.Directive($parse);
  return {link:dir.link};
};
jxdctsec.fileModel.Directive.prototype.link = function(scope, elem, attrs) {
  this.scope = scope;
  this.elem = elem;
  this.attrs = attrs;
  this.restrict = "A";
  var model = this.parse(attrs.fileModel);
  var modelSetter = model.assign;
  elem.bind("change", function() {
    scope.$apply(function() {
      modelSetter(scope, elem[0].files[0]);
    });
  });
};
goog.provide("jxdctopn.version.Directive.factory");
jxdctopn.version.Directive = function(version) {
  this.version = version;
  this.link = this.link.bind(this);
  this.scope;
  this.elem;
  this.attrs;
};
jxdctopn.version.Directive.factory = function(version) {
  var dir = new jxdctopn.version.Directive(version);
  return {link:dir.link};
};
jxdctopn.version.Directive.prototype.link = function(scope, elem, attrs) {
  this.scope = scope;
  this.elem = elem;
  this.attrs = attrs;
  this.elem.text(this.version.get());
};
goog.provide("jxdctopn.constants.Factory");
jxdctopn.constants.Factory.$inject = ["$rootScope", "$http", "$q"];
jxdctopn.constants.Factory = function($rootScope, $http, $q) {
  function getConstants(req) {
    req.url = $rootScope.endPoint + req.url;
    return $http(req).then(success).catch(fail);
    function success(response) {
      return response.data.success_message;
    }
    function fail(error) {
      return $q.reject("rejected");
    }
  }
  var DISTRICTS = [];
  var DISTRICTSPromise = getDistricts().then(function(data) {
    DISTRICTS = data.districts;
  }, function(data) {
    DISTRICTS = [];
  });
  function getDistricts() {
    var req = {method:"GET", url:"/common/constants/districts"};
    return getConstants(req);
  }
  function gotDISTRICTS() {
    return DISTRICTS;
  }
  var DEPARTMENTS = [];
  var DEPARTMENTSPromise = getDepartments().then(function(data) {
    DEPARTMENTS = data.departments;
  }, function(data) {
    DEPARTMENTS = [];
  });
  function getDepartments() {
    var req = {method:"GET", url:"/common/constants/departments"};
    return getConstants(req);
  }
  function gotDEPARTMENTS() {
    return DEPARTMENTS;
  }
  var GENDERS = [];
  var GENDERSPromise = getGenders().then(function(data) {
    GENDERS = data.genders;
  }, function(data) {
    GENDERS = [];
  });
  function getGenders() {
    var req = {method:"GET", url:"/common/constants/genders"};
    return getConstants(req);
  }
  function gotGENDERS() {
    return GENDERS;
  }
  var service = {getConstants:getConstants, getDistricts:getDistricts, gotDISTRICTS:gotDISTRICTS, DISTRICTSPromise:DISTRICTSPromise, getDepartments:getDepartments, gotDEPARTMENTS:gotDEPARTMENTS, DEPARTMENTSPromise:DEPARTMENTSPromise, getGenders:getGenders, gotGENDERS:gotGENDERS, GENDERSPromise:GENDERSPromise};
  return service;
};
goog.provide("jxdctopn.check.Filter.factory");
jxdctopn.check.Filter = function() {
  this.checkmark = "\u2714";
  this.cross = "\u2718";
  this.convert = this.convert.bind(this);
};
jxdctopn.check.Filter.factory = function() {
  var filter = new jxdctopn.check.Filter;
  return filter.convert;
};
jxdctopn.check.Filter.prototype.convert = function(input) {
  return input ? this.checkmark : this.cross;
};
goog.provide("jxdctopn.basic.Service");
jxdctopn.basic.Service.$inject = ["$rootScope", "$http", "$q"];
jxdctopn.basic.Service = function($rootScope, $http, $q) {
  var basic = this;
  basic.signIn = function(rbody) {
    var defer = $q.defer();
    var req = {method:"POST", url:$rootScope.endPoint + "/doctors/sign_in", data:rbody};
    $http(req).success(function(res) {
      defer.resolve(res);
    }).error(function(err, status) {
      defer.reject(err);
    });
    return defer.promise;
  };
  basic.verificationCode = function(rbody) {
    var defer = $q.defer();
    var req = {method:"GET", url:$rootScope.endPoint + "/common/verification_code", params:rbody};
    $http(req).success(function(res) {
      defer.resolve(res);
    }).error(function(err, status) {
      defer.reject(err);
    });
    return defer.promise;
  };
  basic.resetPassword = function(rbody) {
    var defer = $q.defer();
    var req = {method:"POST", url:$rootScope.endPoint + "/doctors/reset_password", data:rbody};
    $http(req).success(function(res) {
      defer.resolve(res);
    }).error(function(err, status) {
      defer.reject(err);
    });
    return defer.promise;
  };
  basic.signUp = function(rbody) {
    var defer = $q.defer();
    var req = {method:"POST", url:$rootScope.endPoint + "/doctors/sign_up", data:rbody};
    $http(req).success(function(res) {
      defer.resolve(res);
    }).error(function(err, status) {
      defer.reject(err);
    });
    return defer.promise;
  };
  basic.fileUpload = function(file) {
    var defer = $q.defer();
    if (file == undefined || file == null || file == "") {
      return null;
    }
    var uploadUrl = $rootScope.endPoint + "/common/uploads";
    var fd = new FormData;
    fd.append("files", file);
    $http.post(uploadUrl, fd, {transformRequest:angular.identity, headers:{"Content-Type":undefined}}).success(function(succ) {
      defer.resolve(succ);
    }).error(function(error) {
      defer.resolve(error);
    });
    return defer.promise;
  };
  return basic;
};
goog.provide("jxdctopn.version.Service");
jxdctopn.version.Service = function() {
  this.version = "0.0.1";
};
jxdctopn.version.Service.prototype.get = function() {
  return this.version;
};
goog.require("jxdctopn.panel.module");
goog.require("jxdctopn.sign_up.module");
goog.require("jxdctopn.version.Directive.factory");
goog.require("jxdctsec.fileModel.Directive.factory");
goog.require("jxdctopn.version.Service");
goog.require("jxdctopn.check.Filter.factory");
goog.require("jxdctopn.basic.Service");
goog.require("jxdctopn.constants.Factory");
function config($stateProvider, $urlRouterProvider, $locationProvider, $httpProvider) {
  $urlRouterProvider.otherwise("/panel/sign_in");
  $httpProvider.defaults.withCredentials = true;
  if (!$httpProvider.defaults.headers.get) {
    $httpProvider.defaults.headers.get = {};
  }
  $httpProvider.defaults.headers.get["If-Modified-Since"] = "Mon, 26 Jul 1997 05:00:00 GMT";
  $httpProvider.defaults.headers.get["Cache-Control"] = "no-cache";
  $httpProvider.defaults.headers.get["Pragma"] = "no-cache";
  $httpProvider.interceptors.push(function($q, $location) {
    return {response:function(response) {
      return response;
    }, responseError:function(response) {
      if (response.status === 401) {
        $location.url("/panel/sign_in");
      }
      return $q.reject(response);
    }};
  });
}
var onChangeConfig = ["$rootScope", "$state", function($rootScope, $state) {
  $rootScope.$on("$stateChangeStart", function(event, toState) {
    if (toState.name === "panel") {
      event.preventDefault();
      $state.go("panel.sign_in", {});
    }
  });
}];
var endPointConfig = ["$rootScope", function($rootScope, $state) {
  $rootScope.endPoint = "";
}];
angular.module("app", ["ui.router", "ngResource", jxdctopn.panel.module.name, jxdctopn.sign_up.module.name]).config(config).run(onChangeConfig).run(endPointConfig).directive("version", jxdctopn.version.Directive.factory).directive("fileModel", jxdctsec.fileModel.Directive.factory).service("version", jxdctopn.version.Service).filter("check", jxdctopn.check.Filter.factory).service("basic", jxdctopn.basic.Service).factory("constants", jxdctopn.constants.Factory);

